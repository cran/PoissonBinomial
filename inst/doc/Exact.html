<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Exact Procedures</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Exact Procedures</h1>



<p>In this package, the following exact algorithms for computing the Poisson Binomial distribution with Bernoulli probabilities <span class="math inline">\(p_1, ..., p_n\)</span> are implemented:</p>
<ul>
<li>the <em>Direct Convolution</em> approach of <a href="http://dx.doi.org/10.1016/j.csda.2018.01.007">Biscarri, Zhao &amp; Brunner (2018)</a>,</li>
<li>the <em>Divide &amp; Conquer FFT Tree Convolution</em> procedure of <a href="http://dx.doi.org/10.1016/j.csda.2018.01.007">Biscarri, Zhao &amp; Brunner (2018)</a>,</li>
<li>the <em>Discrete Fourier Transformation of the Characteristic Function</em> algorithm of <a href="http://dx.doi.org/10.1016/j.csda.2012.10.006">Hong (2013)</a> and</li>
<li>the <em>Recursive Formula</em> of <a href="http://dx.doi.org/10.1109/TR.1984.5221843">Barlow &amp; Heidtmann (1984)</a>.</li>
</ul>
<p>The computation of these procedures is optimized and accelerated by some simple preliminary considerations:</p>
<ol style="list-style-type: decimal">
<li>Are all <span class="math inline">\(p_i\)</span> equal?<br />
In This case, we have an ordinary binomial distribution. The specified method of computation is then ignored.</li>
<li>Are all of the <span class="math inline">\(p_i (i = 1, ..., n)\)</span> 0 or 1?<br />
If one <span class="math inline">\(p_i\)</span> is 1, it is impossible to measure 0 successes. Following the same logic, if two <span class="math inline">\(p_i\)</span> are 1, we cannot observe 0 and 1 successes and so on. In general, a number of <span class="math inline">\(n_1 &gt; 0\)</span> values <span class="math inline">\(p_i = 1\)</span> makes it impossible to measure <span class="math inline">\(0, ..., n_1 - 1\)</span> successes. Likewise, if <span class="math inline">\(n_0 &gt; 0\)</span> of the <span class="math inline">\(p_i = 0\)</span>, we cannot observe <span class="math inline">\(n - n_0 + 1, ..., n\)</span> successes. This leads to three cases (the specified method of computation is ignored in any of them):
<ol style="list-style-type: lower-alpha">
<li>All <span class="math inline">\(p_i = 0\)</span>: The only observable value is <span class="math inline">\(0\)</span>, i.e. <span class="math inline">\(P(X = 0) = 1\)</span> and <span class="math inline">\(P(X \neq 0) = 0\)</span>.</li>
<li>All <span class="math inline">\(p_i = 1\)</span>: The only observable value is <span class="math inline">\(n\)</span>, i.e. <span class="math inline">\(P(X = n) = 1\)</span> and <span class="math inline">\(P(X \neq n) = 0\)</span>.</li>
<li>All <span class="math inline">\(p_i \in \{0, 1\}\)</span>: The only observable value is <span class="math inline">\(n_1\)</span>, i.e. <span class="math inline">\(P(X = n_1) = 1\)</span> and <span class="math inline">\(P(X \neq n_1) = 0\)</span>.</li>
</ol></li>
<li>Are there <span class="math inline">\(p_i \notin \{0, 1\}\)</span>?<br />
Then the only observable values are <span class="math inline">\(n_1, n_1 + 1, ..., n - n_0\)</span>, i.e. <span class="math inline">\(P(X \in \{n_1, ..., n - n_0\}) &gt; 0\)</span> and <span class="math inline">\(P(X &lt; n_1) = P(X &gt; n - n_0) = 0\)</span>. As a result, <span class="math inline">\(X\)</span> can be expressed as <span class="math inline">\(X = n_1 + Y\)</span> with <span class="math inline">\(Y \sim PBin(\{p_i|0 &lt; p_i &lt; 1\})\)</span> and <span class="math inline">\(|\{p_i|0 &lt; p_i &lt; 1\}| = n - n_0 - n_1\)</span>. Thus, the Poisson Binomial distribution must only be computed for <span class="math inline">\(Y\)</span>.</li>
</ol>
<p>These cases are illustrated in the following example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(PoissonBinomial)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># Case 1</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, <span class="kw">rep</span>(<span class="fl">0.3</span>, <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; [1] 0.0823543 0.2470629 0.3176523 0.2268945 0.0972405 0.0250047 0.0035721</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; [8] 0.0002187</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">7</span>, <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; [1] 0.0823543 0.2470629 0.3176523 0.2268945 0.0972405 0.0250047 0.0035721</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; [8] 0.0002187</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co"># equal results</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># Case 2</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; [1] 1 0 0 0 0 0 0 0</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; [1] 0 0 0 0 0 0 0 1</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt; [1] 0 0 0 1 0 0 0 0</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co"># Case 3</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt; [1] 0.0000 0.0864 0.4344 0.3784 0.0944 0.0064 0.0000 0.0000</span></a></code></pre></div>
<div id="direct-convolution" class="section level2">
<h2>Direct Convolution</h2>
<p>The <em>Direct Convolution</em> (DC) approach is requested with <code>method = &quot;Convolve&quot;</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">pp &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">wt &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp, wt, <span class="st">&quot;Convolve&quot;</span>)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt;  [1] 3.574462e-35 1.120280e-32 1.685184e-30 1.620524e-28 1.119523e-26</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;  [6] 5.920060e-25 2.493263e-23 8.591850e-22 2.470125e-20 6.011429e-19</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; [11] 1.252345e-17 2.253115e-16 3.525477e-15 4.825171e-14 5.803728e-13</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; [16] 6.158735e-12 5.784692e-11 4.822437e-10 3.576566e-09 2.364563e-08</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; [21] 1.395965e-07 7.370448e-07 3.484836e-06 1.477208e-05 5.619632e-05</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; [26] 1.920240e-04 5.897928e-04 1.629272e-03 4.049768e-03 9.060183e-03</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; [31] 1.824629e-02 3.307754e-02 5.396724e-02 7.921491e-02 1.045505e-01</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; [36] 1.239854e-01 1.319896e-01 1.259938e-01 1.077029e-01 8.232174e-02</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; [41] 5.616422e-02 3.413623e-02 1.844304e-02 8.835890e-03 3.743554e-03</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; [46] 1.398320e-03 4.589049e-04 1.318064e-04 3.298425e-05 7.154649e-06</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; [51] 1.337083e-06 2.137543e-07 2.898296e-08 3.298587e-09 3.110922e-10</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; [56] 2.392070e-11 1.468267e-12 6.991155e-14 2.478218e-15 6.130807e-17</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; [61] 9.411166e-19 6.727527e-21</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="kw">ppbinom</span>(<span class="ot">NULL</span>, pp, wt, <span class="st">&quot;Convolve&quot;</span>)</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt;  [1] 3.574462e-35 1.123854e-32 1.696423e-30 1.637488e-28 1.135898e-26</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt;  [6] 6.033650e-25 2.553600e-23 8.847210e-22 2.558597e-20 6.267289e-19</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; [11] 1.315018e-17 2.384617e-16 3.763939e-15 5.201565e-14 6.323884e-13</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; [16] 6.791123e-12 6.463805e-11 5.468818e-10 4.123448e-09 2.776908e-08</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; [21] 1.673656e-07 9.044104e-07 4.389247e-06 1.916133e-05 7.535765e-05</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt; [26] 2.673817e-04 8.571745e-04 2.486446e-03 6.536215e-03 1.559640e-02</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt; [31] 3.384269e-02 6.692022e-02 1.208875e-01 2.001024e-01 3.046529e-01</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt; [36] 4.286383e-01 5.606280e-01 6.866217e-01 7.943246e-01 8.766463e-01</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt; [41] 9.328105e-01 9.669468e-01 9.853898e-01 9.942257e-01 9.979692e-01</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt; [46] 9.993676e-01 9.998265e-01 9.999583e-01 9.999913e-01 9.999984e-01</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt; [51] 9.999998e-01 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt; [56] 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co">#&gt; [61] 1.000000e+00 1.000000e+00</span></a></code></pre></div>
</div>
<div id="divide-conquer-fft-tree-convolution" class="section level2">
<h2>Divide &amp; Conquer FFT Tree Convolution</h2>
<p>The <em>Divide &amp; Conquer FFT Tree Convolution</em> (DC-FFT) approach is requested with <code>method = &quot;DivideFFT&quot;</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">pp &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">wt &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp, wt, <span class="st">&quot;DivideFFT&quot;</span>)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt;  [1] 3.574462e-35 1.120280e-32 1.685184e-30 1.620524e-28 1.119523e-26</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;  [6] 5.920060e-25 2.493263e-23 8.591850e-22 2.470125e-20 6.011429e-19</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; [11] 1.252345e-17 2.253115e-16 3.525477e-15 4.825171e-14 5.803728e-13</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; [16] 6.158735e-12 5.784692e-11 4.822437e-10 3.576566e-09 2.364563e-08</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; [21] 1.395965e-07 7.370448e-07 3.484836e-06 1.477208e-05 5.619632e-05</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; [26] 1.920240e-04 5.897928e-04 1.629272e-03 4.049768e-03 9.060183e-03</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; [31] 1.824629e-02 3.307754e-02 5.396724e-02 7.921491e-02 1.045505e-01</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; [36] 1.239854e-01 1.319896e-01 1.259938e-01 1.077029e-01 8.232174e-02</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; [41] 5.616422e-02 3.413623e-02 1.844304e-02 8.835890e-03 3.743554e-03</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; [46] 1.398320e-03 4.589049e-04 1.318064e-04 3.298425e-05 7.154649e-06</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; [51] 1.337083e-06 2.137543e-07 2.898296e-08 3.298587e-09 3.110922e-10</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; [56] 2.392070e-11 1.468267e-12 6.991155e-14 2.478218e-15 6.130807e-17</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; [61] 9.411166e-19 6.727527e-21</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="kw">ppbinom</span>(<span class="ot">NULL</span>, pp, wt, <span class="st">&quot;DivideFFT&quot;</span>)</a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt;  [1] 3.574462e-35 1.123854e-32 1.696423e-30 1.637488e-28 1.135898e-26</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt;  [6] 6.033650e-25 2.553600e-23 8.847210e-22 2.558597e-20 6.267289e-19</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; [11] 1.315018e-17 2.384617e-16 3.763939e-15 5.201565e-14 6.323884e-13</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; [16] 6.791123e-12 6.463805e-11 5.468818e-10 4.123448e-09 2.776908e-08</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; [21] 1.673656e-07 9.044104e-07 4.389247e-06 1.916133e-05 7.535765e-05</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; [26] 2.673817e-04 8.571745e-04 2.486446e-03 6.536215e-03 1.559640e-02</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; [31] 3.384269e-02 6.692022e-02 1.208875e-01 2.001024e-01 3.046529e-01</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt; [36] 4.286383e-01 5.606280e-01 6.866217e-01 7.943246e-01 8.766463e-01</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt; [41] 9.328105e-01 9.669468e-01 9.853898e-01 9.942257e-01 9.979692e-01</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt; [46] 9.993676e-01 9.998265e-01 9.999583e-01 9.999913e-01 9.999984e-01</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt; [51] 9.999998e-01 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; [56] 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt; [61] 1.000000e+00 1.000000e+00</span></a></code></pre></div>
<p>By design, as proposed by <a href="http://dx.doi.org/10.1016/j.csda.2018.01.007">Biscarri, Zhao &amp; Brunner (2018)</a>, its results are identical to the DC procedure, if <span class="math inline">\(n \leq 750\)</span>. Thus, differences can be observed for larger <span class="math inline">\(n &gt; 750\)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">pp1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">751</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">pp2 &lt;-<span class="st"> </span>pp1[<span class="dv">1</span><span class="op">:</span><span class="dv">750</span>]</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw">sum</span>(<span class="kw">abs</span>(<span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp2, <span class="dt">method =</span> <span class="st">&quot;DivideFFT&quot;</span>) <span class="op">-</span><span class="st"> </span><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp2, <span class="dt">method =</span> <span class="st">&quot;Convolve&quot;</span>)))</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="kw">sum</span>(<span class="kw">abs</span>(<span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp1, <span class="dt">method =</span> <span class="st">&quot;DivideFFT&quot;</span>) <span class="op">-</span><span class="st"> </span><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp1, <span class="dt">method =</span> <span class="st">&quot;Convolve&quot;</span>)))</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; [1] 5.704337e-16</span></a></code></pre></div>
<p>The reason is that the DC-FFT method splits the input <code>probs</code> vector into as equally sized parts as possible and computes their distributions separately with the DC approach. The results of the portions are then convoluted by means of the Fast Fourier Transformation. As proposed by <a href="http://dx.doi.org/10.1016/j.csda.2018.01.007">Biscarri, Zhao &amp; Brunner (2018)</a>, no splitting is done for <span class="math inline">\(n \leq 750\)</span>. In addition, the DC-FFT procedure does not produce probabilities <span class="math inline">\(\leq 5.55e\text{-}17\)</span>, i.e. smaller values are rounded off to 0, if <span class="math inline">\(n &gt; 750\)</span>, whereas the smallest possible result of the DC algorithm is <span class="math inline">\(\sim 1e\text{-}323\)</span>. This is most likely caused by the used FFTW3 library.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">pp1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">751</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">d1 &lt;-<span class="st"> </span><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp1, <span class="dt">method =</span> <span class="st">&quot;DivideFFT&quot;</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">d2 &lt;-<span class="st"> </span><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp1, <span class="dt">method =</span> <span class="st">&quot;Convolve&quot;</span>)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw">min</span>(d1[d1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>])</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; [1] 6.889658e-17</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="kw">min</span>(d2[d2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>])</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; [1] 1.635357e-321</span></a></code></pre></div>
</div>
<div id="discrete-fourier-transformation-of-the-characteristic-function" class="section level2">
<h2>Discrete Fourier Transformation of the Characteristic Function</h2>
<p>The <em>Discrete Fourier Transformation of the Characteristic Function</em> (DFT-CF) approach is requested with <code>method = &quot;Characteristic&quot;</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">pp &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">wt &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp, wt, <span class="st">&quot;Characteristic&quot;</span>)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt;  [1] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt;  [6] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; [11] 0.000000e+00 2.238353e-16 3.549132e-15 4.829828e-14 5.804377e-13</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; [16] 6.158818e-12 5.784702e-11 4.822438e-10 3.576566e-09 2.364563e-08</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; [21] 1.395965e-07 7.370448e-07 3.484836e-06 1.477208e-05 5.619632e-05</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; [26] 1.920240e-04 5.897928e-04 1.629272e-03 4.049768e-03 9.060183e-03</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; [31] 1.824629e-02 3.307754e-02 5.396724e-02 7.921491e-02 1.045505e-01</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; [36] 1.239854e-01 1.319896e-01 1.259938e-01 1.077029e-01 8.232174e-02</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; [41] 5.616422e-02 3.413623e-02 1.844304e-02 8.835890e-03 3.743554e-03</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; [46] 1.398320e-03 4.589049e-04 1.318064e-04 3.298425e-05 7.154649e-06</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; [51] 1.337083e-06 2.137543e-07 2.898296e-08 3.298587e-09 3.110923e-10</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; [56] 2.392079e-11 1.468354e-12 6.994931e-14 2.513558e-15 5.551115e-17</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; [61] 0.000000e+00 0.000000e+00</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="kw">ppbinom</span>(<span class="ot">NULL</span>, pp, wt, <span class="st">&quot;Characteristic&quot;</span>)</a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt;  [1] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt;  [6] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; [11] 0.000000e+00 2.238353e-16 3.772968e-15 5.207125e-14 6.325089e-13</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; [16] 6.791327e-12 6.463834e-11 5.468822e-10 4.123448e-09 2.776908e-08</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; [21] 1.673656e-07 9.044104e-07 4.389247e-06 1.916133e-05 7.535765e-05</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt; [26] 2.673817e-04 8.571745e-04 2.486446e-03 6.536215e-03 1.559640e-02</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt; [31] 3.384269e-02 6.692022e-02 1.208875e-01 2.001024e-01 3.046529e-01</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt; [36] 4.286383e-01 5.606280e-01 6.866217e-01 7.943246e-01 8.766463e-01</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt; [41] 9.328105e-01 9.669468e-01 9.853898e-01 9.942257e-01 9.979692e-01</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; [46] 9.993676e-01 9.998265e-01 9.999583e-01 9.999913e-01 9.999984e-01</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt; [51] 9.999998e-01 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt; [56] 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00</span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; [61] 1.000000e+00 1.000000e+00</span></a></code></pre></div>
<p>As can be seen, the DFT-CF procedure does not produce probabilities <span class="math inline">\(\leq 5.55e\text{-}17\)</span>, i.e. smaller values are rounded off to 0, most likely due to the used FFTW3 library.</p>
</div>
<div id="recursive-formula" class="section level2">
<h2>Recursive Formula</h2>
<p>The <em>Recursive Formula</em> (RF) approach is requested with <code>method = &quot;Recursive&quot;</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">pp &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">wt &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp, wt, <span class="st">&quot;Recursive&quot;</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;  [1] 3.574462e-35 1.120280e-32 1.685184e-30 1.620524e-28 1.119523e-26</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;  [6] 5.920060e-25 2.493263e-23 8.591850e-22 2.470125e-20 6.011429e-19</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; [11] 1.252345e-17 2.253115e-16 3.525477e-15 4.825171e-14 5.803728e-13</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; [16] 6.158735e-12 5.784692e-11 4.822437e-10 3.576566e-09 2.364563e-08</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; [21] 1.395965e-07 7.370448e-07 3.484836e-06 1.477208e-05 5.619632e-05</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; [26] 1.920240e-04 5.897928e-04 1.629272e-03 4.049768e-03 9.060183e-03</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; [31] 1.824629e-02 3.307754e-02 5.396724e-02 7.921491e-02 1.045505e-01</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; [36] 1.239854e-01 1.319896e-01 1.259938e-01 1.077029e-01 8.232174e-02</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; [41] 5.616422e-02 3.413623e-02 1.844304e-02 8.835890e-03 3.743554e-03</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; [46] 1.398320e-03 4.589049e-04 1.318064e-04 3.298425e-05 7.154649e-06</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; [51] 1.337083e-06 2.137543e-07 2.898296e-08 3.298587e-09 3.110922e-10</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; [56] 2.392070e-11 1.468267e-12 6.991155e-14 2.478218e-15 6.130807e-17</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; [61] 9.411166e-19 6.727527e-21</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="kw">ppbinom</span>(<span class="ot">NULL</span>, pp, wt, <span class="st">&quot;Recursive&quot;</span>)</a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt;  [1] 3.574462e-35 1.123854e-32 1.696423e-30 1.637488e-28 1.135898e-26</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt;  [6] 6.033650e-25 2.553600e-23 8.847210e-22 2.558597e-20 6.267289e-19</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; [11] 1.315018e-17 2.384617e-16 3.763939e-15 5.201565e-14 6.323884e-13</span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; [16] 6.791123e-12 6.463805e-11 5.468818e-10 4.123448e-09 2.776908e-08</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; [21] 1.673656e-07 9.044104e-07 4.389247e-06 1.916133e-05 7.535765e-05</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt; [26] 2.673817e-04 8.571745e-04 2.486446e-03 6.536215e-03 1.559640e-02</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt; [31] 3.384269e-02 6.692022e-02 1.208875e-01 2.001024e-01 3.046529e-01</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt; [36] 4.286383e-01 5.606280e-01 6.866217e-01 7.943246e-01 8.766463e-01</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt; [41] 9.328105e-01 9.669468e-01 9.853898e-01 9.942257e-01 9.979692e-01</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt; [46] 9.993676e-01 9.998265e-01 9.999583e-01 9.999913e-01 9.999984e-01</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt; [51] 9.999998e-01 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt; [56] 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00</span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt; [61] 1.000000e+00 1.000000e+00</span></a></code></pre></div>
<p>Obviously, the RF procedure does produce probabilities <span class="math inline">\(\leq 5.55e\text{-}17\)</span>, because it does not rely on the FFTW3 library. Furthermore, it yields the same results as the DC method.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">pp &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">wt &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1000</span>, <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw">sum</span>(<span class="kw">abs</span>(<span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp, wt, <span class="st">&quot;Convolve&quot;</span>) <span class="op">-</span><span class="st"> </span><span class="kw">dpbinom</span>(<span class="ot">NULL</span>, pp, wt, <span class="st">&quot;Recursive&quot;</span>)))</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; [1] 0</span></a></code></pre></div>
</div>
<div id="performance-comparisons" class="section level2">
<h2>Performance Comparisons</h2>
<p>To assess the performance of the exact procedures, we use the <code>microbenchmark</code> package. Each algorithm has to calculate the PMF repeatedly based on random probability vectors. The run times are then summarized in a table that presents, among other statistics, their minima, maxima and means. The following results were recorded on an AMD Ryzen 7 1800X with 32 GiB of RAM and Ubuntu 18.04.3 (running inside a VirtualBox VM; the host system is Windows 10 Education).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">f1 &lt;-<span class="st"> </span><span class="cf">function</span>() <span class="kw">dpbinom</span>(<span class="ot">NULL</span>, <span class="kw">runif</span>(<span class="dv">4000</span>), <span class="dt">method =</span> <span class="st">&quot;DivideFFT&quot;</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">f2 &lt;-<span class="st"> </span><span class="cf">function</span>() <span class="kw">dpbinom</span>(<span class="ot">NULL</span>, <span class="kw">runif</span>(<span class="dv">4000</span>), <span class="dt">method =</span> <span class="st">&quot;Convolve&quot;</span>)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">f3 &lt;-<span class="st"> </span><span class="cf">function</span>() <span class="kw">dpbinom</span>(<span class="ot">NULL</span>, <span class="kw">runif</span>(<span class="dv">4000</span>), <span class="dt">method =</span> <span class="st">&quot;Characteristic&quot;</span>)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">f4 &lt;-<span class="st"> </span><span class="cf">function</span>() <span class="kw">dpbinom</span>(<span class="ot">NULL</span>, <span class="kw">runif</span>(<span class="dv">4000</span>), <span class="dt">method =</span> <span class="st">&quot;Recursive&quot;</span>)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="kw">microbenchmark</span>(<span class="kw">f1</span>(), <span class="kw">f2</span>(), <span class="kw">f3</span>(), <span class="kw">f4</span>())</a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; Unit: milliseconds</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt;  expr       min        lq      mean   median        uq      max neval</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt;  f1()  5.478379  5.884806  6.714503  6.16171  6.764316 21.78661   100</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt;  f2() 16.509786 17.051717 18.341106 17.46519 18.628877 59.29212   100</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt;  f3() 22.207496 22.957959 23.424588 23.14626 23.367803 41.59981   100</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt;  f4() 34.791255 36.084817 36.425160 36.34899 36.543581 42.72910   100</span></a></code></pre></div>
<p>Clearly, the DC-FFT procedure is the fastest, followed by the DC and DFT-CF methods, which need roughly 3 times as much time, and the RF approach. DC and DFT-CF procedures exhibit almost equal mean execution speed, with the DC algorithm being slightly faster (and with some advantage in precision, as stated before). The RF approach is the slowest one and its computation takes roughly twice as long as those of the DC procedure.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
